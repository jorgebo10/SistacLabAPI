stage('Commit') {
    node {
        git url: 'https://github.com/jorgebo10/SistacLabAPI.git', branch:'development'
        def nodeHome = tool 'node5.12.0'
        env.PATH="${env.PATH}:${nodeHome}/bin"
        sh 'npm install'
        sh 'grunt unittest'
        sh 'grunt compress'
        publishHTML([allowMissing: false, 
            alwaysLinkToLastBuild: false, 
            keepAll: false, 
            reportDir: 'coverage/lcov-report', 
            reportFiles: 'index.html', 
            reportName: 'HTML Report']) 
	archiveArtifacts artifacts: 'dist/sistacLabAPI-${env.BUILD_TAG}.zip', excludes: null

    }
}

stage('Acceptance test') {
    node {
          def nodeHome = tool 'node5.12.0'
          env.PATH="${env.PATH}:${nodeHome}/bin"
          sh 'grunt unittest'
          input message: "Does it look good?"
    }
}
